{"version":3,"sources":["../../src/models/users.model.ts"],"sourcesContent":["/**\n * Sequelize model definition for users.\n * Represents user entities with personal and authentication fields, including associations for avatar images.\n */\nimport { Sequelize, DataTypes, Model, Optional } from \"sequelize\";\nimport { User } from \"@interfaces/user.interface\";\n\nimport { FileModel } from \"@models/files.model\";\nimport { UserRole } from '@interfaces/authentication/user-role.interface';\n\n/**\n * Type for user creation attributes, omitting pk, uuid, full_name, and display_picture for auto-generation.\n */\nexport type UserCreationAttributes = Optional<User, \"pk\" | \"uuid\" | \"full_name\" | \"display_picture\">;\n\n/**\n * UserModel class for Sequelize ORM.\n * Implements User interface. Attributes are handled by Sequelize.\n */\nexport class UserModel extends Model<User, UserCreationAttributes> implements User {\n\n}\n\n// Declaration merging: this tells TypeScript that UserModel instances have User properties\nexport interface UserModel extends User {}\n\n/**\n * Initializes the UserModel with Sequelize instance and sets up model fields and associations.\n * @param sequelize - Sequelize connection instance\n * @returns UserModel class\n */\nexport default function (sequelize: Sequelize): typeof UserModel {\n  UserModel.init(\n    {\n      pk: {\n        type: DataTypes.INTEGER,\n        autoIncrement: true,\n        primaryKey: true,\n      },\n      uuid: {\n        type: DataTypes.UUID,\n        defaultValue: DataTypes.UUIDV4,\n      },\n      full_name: {\n        type: DataTypes.STRING,\n        allowNull: true,\n      },\n      display_picture: {\n        type: DataTypes.INTEGER,\n        allowNull: true,\n      },\n      email: {\n        allowNull: false,\n        type: DataTypes.STRING,\n      },\n      password: {\n        allowNull: false,\n        type: DataTypes.TEXT,\n      },\n      email_verified_at: {\n        type: DataTypes.DATE,\n        allowNull: true\n      }\n    },\n    {\n      tableName: \"users\", // Table name in DB\n      timestamps: true,    // Enable created_at/updated_at\n      paranoid: true,      // Enable soft deletes (deleted_at)\n      sequelize,           // Sequelize instance\n      defaultScope: {\n        attributes: { exclude: [\"password\"] }, // Exclude password from queries\n      },\n    },\n  );\n\n  // Set up associations for avatar images\n  FileModel.hasOne(UserModel, {\n    foreignKey: \"display_picture\",\n    as: \"avatar\"\n  });\n\n  UserModel.belongsTo(FileModel, {\n    foreignKey: \"display_picture\",\n    as: \"avatar\"\n  });\n\n  return UserModel;\n}"],"names":["UserModel","Model","sequelize","init","pk","type","DataTypes","INTEGER","autoIncrement","primaryKey","uuid","UUID","defaultValue","UUIDV4","full_name","STRING","allowNull","display_picture","email","password","TEXT","email_verified_at","DATE","tableName","timestamps","paranoid","defaultScope","attributes","exclude","FileModel","hasOne","foreignKey","as","belongsTo"],"mappings":";;;;;;;;;;;QAmBaA;eAAAA;;QAYb;eAAA;;;2BA3BsD;4BAG5B;AAYnB,IAAA,AAAMA,YAAN,MAAMA,kBAAkBC,gBAAK;AAEpC;AAUe,SAAf,SAAyBC,SAAoB;IAC3CF,UAAUG,IAAI,CACZ;QACEC,IAAI;YACFC,MAAMC,oBAAS,CAACC,OAAO;YACvBC,eAAe;YACfC,YAAY;QACd;QACAC,MAAM;YACJL,MAAMC,oBAAS,CAACK,IAAI;YACpBC,cAAcN,oBAAS,CAACO,MAAM;QAChC;QACAC,WAAW;YACTT,MAAMC,oBAAS,CAACS,MAAM;YACtBC,WAAW;QACb;QACAC,iBAAiB;YACfZ,MAAMC,oBAAS,CAACC,OAAO;YACvBS,WAAW;QACb;QACAE,OAAO;YACLF,WAAW;YACXX,MAAMC,oBAAS,CAACS,MAAM;QACxB;QACAI,UAAU;YACRH,WAAW;YACXX,MAAMC,oBAAS,CAACc,IAAI;QACtB;QACAC,mBAAmB;YACjBhB,MAAMC,oBAAS,CAACgB,IAAI;YACpBN,WAAW;QACb;IACF,GACA;QACEO,WAAW;QACXC,YAAY;QACZC,UAAU;QACVvB;QACAwB,cAAc;YACZC,YAAY;gBAAEC,SAAS;oBAAC;iBAAW;YAAC;QACtC;IACF;IAIFC,qBAAS,CAACC,MAAM,CAAC9B,WAAW;QAC1B+B,YAAY;QACZC,IAAI;IACN;IAEAhC,UAAUiC,SAAS,CAACJ,qBAAS,EAAE;QAC7BE,YAAY;QACZC,IAAI;IACN;IAEA,OAAOhC;AACT"}